{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://dataversedevkit.dev/schemas/plugin.manifest.v1.json",
  "title": "Dataverse DevKit Plugin Manifest",
  "description": "Manifest schema for DDK plugins",
  "type": "object",
  "required": ["id", "name", "version", "author", "description", "ui", "backend", "permissions"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9]+(\\.[a-z0-9]+)+$",
      "description": "Unique plugin ID in reverse-DNS notation (e.g., com.contoso.ddk.pluginname)"
    },
    "name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 64,
      "description": "Human-readable plugin name"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+(-[a-z0-9.]+)?$",
      "description": "Semantic version (e.g., 1.0.0 or 1.0.0-beta.1)"
    },
    "author": {
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": {
          "type": "string"
        },
        "email": {
          "type": "string",
          "format": "email"
        },
        "url": {
          "type": "string",
          "format": "uri"
        }
      }
    },
    "description": {
      "type": "string",
      "minLength": 10,
      "maxLength": 500,
      "description": "Brief description of plugin functionality"
    },
    "icon": {
      "type": "string",
      "description": "Path to plugin icon (relative to manifest)"
    },
    "ui": {
      "type": "object",
      "required": ["entry"],
      "properties": {
        "entry": {
          "type": "string",
          "description": "Entry point for UI module (e.g., ui/remoteEntry.js)"
        },
        "mount": {
          "type": "string",
          "default": "mount",
          "description": "Name of exported mount function"
        }
      }
    },
    "backend": {
      "type": "object",
      "required": ["entryAssembly"],
      "properties": {
        "entryAssembly": {
          "type": "string",
          "description": "Path to plugin backend DLL (e.g., backend/MyPlugin.dll)"
        },
        "runtimeVersion": {
          "type": "string",
          "description": "Target .NET runtime version (e.g., net10.0)"
        }
      }
    },
    "permissions": {
      "type": "object",
      "description": "Capabilities required by this plugin",
      "properties": {
        "dataverse": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["query", "execute", "metadata", "admin"]
          },
          "uniqueItems": true,
          "description": "Dataverse access levels"
        },
        "filesystem": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["temp", "documents", "downloads"]
          },
          "uniqueItems": true,
          "description": "Filesystem access scopes"
        },
        "network": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri"
          },
          "description": "Allowed external network endpoints"
        },
        "clipboard": {
          "type": "boolean",
          "default": false,
          "description": "Clipboard read/write access"
        }
      },
      "additionalProperties": false
    },
    "homepage": {
      "type": "string",
      "format": "uri",
      "description": "Plugin homepage or documentation URL"
    },
    "repository": {
      "type": "string",
      "format": "uri",
      "description": "Source code repository URL"
    },
    "license": {
      "type": "string",
      "description": "SPDX license identifier"
    }
  },
  "additionalProperties": false
}
